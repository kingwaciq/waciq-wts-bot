<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WhatsApp OTP Session</title>
</head>
<body>
<h2>Enter your WhatsApp Number</h2>
<input id="number" placeholder="+1234567890" />
<button id="getOtpBtn">Get OTP</button>

<h2>Enter OTP</h2>
<input id="otp" placeholder="123456" />
<button id="verifyBtn">Verify OTP</button>
<input id="number" type="tel" placeholder="+93761234567" required pattern="^\+[1-9]\d{7,14}$" />

<script>
document.getElementById("requestBtn").addEventListener("click", async ()=>{
  const number = document.getElementById("number").value.trim();

  // ✅ validate
  const regex = /^\+[1-9]\d{7,14}$/;
  if (!regex.test(number)) {
    alert("❌ Please enter a valid WhatsApp number (e.g. +93761234567)");
    return;
  }

  const res = await fetch("/api/requestCode", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ number })
  });

  const data = await res.json();
  if (data.error) {
    alert("❌ Error: " + data.error);
  } else {
    alert("✅ OTP sent to Telegram (and maybe WhatsApp if enabled). Your code: " + data.otp);
  }
});
</script> 
</body>
</html> 
