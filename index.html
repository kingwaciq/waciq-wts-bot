<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WhatsApp OTP Session</title>
</head>
<body>
<h2>Enter your WhatsApp Number</h2>
<input id="number" placeholder="+1234567890" />
<button id="getOtpBtn">Get OTP</button>

<h2>Enter OTP</h2>
<input id="otp" placeholder="123456" />
<button id="verifyBtn">Verify OTP</button>

<script>
let sessionId = null;

document.getElementById('getOtpBtn').addEventListener('click', async ()=>{
  const number = document.getElementById('number').value;
  const res = await fetch('/api/requestCode', {
    method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ number })
  });
  const data = await res.json();
  alert(data.message || data.error);
});

document.getElementById('verifyBtn').addEventListener('click', async ()=>{
  const number = document.getElementById('number').value;
  const otp = document.getElementById('otp').value;
  const res = await fetch('/api/verifyCode', {
    method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ number, otp })
  });
  const data = await res.json();
  if(data.success){
    sessionId = data.sessionId;
    alert('OTP verified! Session active. All WhatsApp messages from this number will go to the bot.');
  } else {
    alert(data.error);
  }
});
</script>
</body>
</html> 
